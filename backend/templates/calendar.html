{% extends 'base.html' %}

{% block title %}Pace Â· Calendar{% endblock %}

{% block content %}
<section class="page-heading">
    <div>
        <p class="eyebrow">Calendar</p>
        <h1>Shape your calendar around recovery, not just delivery.</h1>
        <p class="lede">Glance at the month ahead, add intentional breaks, and sync with agents that know your capacity.</p>
    </div>
    <div class="callout-card">
        <h3>Tip</h3>
        <p>Pair each intense block with a deliberate resetâ€”even five minutes is enough to prevent context fatigue.</p>
    </div>
</section>

<section class="calendar-actions">
    <div class="event-form-wrapper">
        <button id="toggleEventForm" class="secondary-button">âž• Add restorative block</button>
        <form id="addEventForm" class="event-form" hidden>
            <div class="field">
                <label for="eventSummary">Title</label>
                <input type="text" id="eventSummary" placeholder="Walk-and-reset or focus sprint" required>
            </div>
            <div class="field">
                <label for="eventDescription">Description</label>
                <textarea id="eventDescription" rows="2" placeholder="Optional context for future you"></textarea>
            </div>
            <div class="field-grid">
                <div class="field">
                    <label for="eventStartOffset">Starts in (hours)</label>
                    <input type="number" id="eventStartOffset" min="0" step="0.5" value="1">
                </div>
                <div class="field">
                    <label for="eventDuration">Duration (hours)</label>
                    <input type="number" id="eventDuration" min="0.25" step="0.25" value="1">
                </div>
            </div>
            <div class="form-actions">
                <button type="submit" class="primary-button">Create event</button>
                <button type="button" id="cancelEventForm" class="ghost-button">Cancel</button>
            </div>
            <p id="eventStatus" class="helper-text">Events sync directly to your primary Google Calendar.</p>
        </form>
    </div>
    <div class="break-suggestions">
        <h2>Smart Break Scheduler</h2>
        <p class="helper-text">Let AI analyze your calendar, stress levels, and recent reflections to suggest optimal breaks.</p>
        
        <div class="scheduler-actions">
            <button id="generateBreaks" class="primary-button">ðŸ§  Generate Smart Breaks</button>
            <button id="autoScheduleBreaks" class="secondary-button">ðŸ“… Auto-Schedule to Calendar</button>
        </div>
        
        <div id="breakSuggestions" class="break-list">
            <p class="placeholder">Click "Generate Smart Breaks" to see personalized suggestions based on your stress level and calendar density.</p>
        </div>
        
        <p id="breakStatus" class="helper-text"></p>
    </div>
</section>

<section class="calendar-feed">
    <header class="feed-header">
        <h2>Upcoming events</h2>
        <button id="refreshEvents" class="ghost-button">Refresh</button>
    </header>
    <div class="event-list" id="eventList">
        {% if events %}
            {% for event in events %}
            <article class="event-card">
                <div class="event-summary">
                    <h3>{{ event.summary or 'Untitled event' }}</h3>
                    <p class="event-time">
                        {{ event.start.get('formatted', event.start.get('dateTime', event.start.get('date'))) }}
                        {% if event.end %}
                            Â· Ends {{ event.end.get('formatted', event.end.get('dateTime', event.end.get('date'))) }}
                        {% endif %}
                    </p>
                </div>
                {% if event.description %}
                <p class="event-description">{{ event.description }}</p>
                {% endif %}
            </article>
            {% endfor %}
        {% else %}
            <p class="placeholder">No upcoming events detected. Sync with Google to load your schedule.</p>
        {% endif %}
    </div>
</section>
{% endblock %}